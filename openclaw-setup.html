<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OpenClaw Setup Eastern Shore Maryland | Eastern Shore AI</title>
  <meta name="description" content="OpenClaw Setup Eastern Shore Maryland: $100, no additional fees, 30 days of technical support, secure setup and hardening." />
  <link rel="canonical" href="https://easternshore.ai/openclaw-setup.html" />
  <style>
    :root { --bg:#070b14; --bg2:#0e1630; --card:#121b38; --text:#e8eeff; --muted:#9fb0d8; --cyan:#35e7ff; --line:#24335f; --violet:#8f7bff; }
    * { box-sizing:border-box; }
    body { margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif; color:var(--text);
      background:radial-gradient(circle at 20% 10%, #182a57 0%, var(--bg) 40%), linear-gradient(140deg, var(--bg), var(--bg2)); }
    .container { max-width:920px; margin:0 auto; padding:1.2rem; }
    a { color:var(--cyan); }
    .card { background:var(--card); border:1px solid var(--line); border-radius:12px; padding:1rem; }
    h1 { margin:.2rem 0 .6rem; }
    p { color:var(--muted); line-height:1.6; }
    ul { color:var(--muted); line-height:1.6; }
    .btn { border:1px solid var(--line); background:transparent; color:var(--text); border-radius:10px; padding:.55rem .85rem; cursor:pointer; font-weight:600; }
    .btn-primary { background:linear-gradient(145deg,#4a6cf7,#3b5de7); border-color:#5a7aff; color:#fff; box-shadow:0 0 16px rgba(74,108,247,0.3); }
    .booking-grid { display:grid; grid-template-columns:1fr 280px; gap:1rem; align-items:start; }
    .book-pay-panel { background:#0d1734; border:1px solid var(--line); border-radius:12px; padding:.9rem; }
    .book-pay-panel p { margin:.2rem 0 .8rem; font-size:.92rem; }
    .btn-wide { width:100%; display:inline-flex; justify-content:center; text-decoration:none; }
    .form-grid { display:grid; grid-template-columns:1fr 1fr; gap:.7rem; margin-top:.7rem; }
    .full { grid-column:1 / -1; }
    label { display:block; font-size:.85rem; color:var(--muted); margin-bottom:.25rem; }
    input,textarea,select { width:100%; border:1px solid var(--line); border-radius:10px; background:#0a1230; color:var(--text); padding:.65rem .7rem; font:inherit; }
    textarea { min-height:120px; resize:vertical; }
    .form-actions { display:flex; justify-content:flex-end; margin-top:.9rem; }
    .form-status { margin-top:.6rem; color:var(--muted); min-height:1.2em; }
    .form-status.ok { color:#7dffb1; } .form-status.err { color:#ff8ea8; }

    body { padding-bottom: 86px; }

    footer {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 200;
      margin: 0;
      padding: 0.65rem 1rem calc(0.65rem + env(safe-area-inset-bottom));
      color: #8092c3;
      font-size: 0.85rem;
      text-align: center;
      background: rgba(8, 12, 28, 0.9);
      border-top: 1px solid var(--line);
      backdrop-filter: blur(8px);
    }

    .footer-link {
      display: inline-block;
      margin: 0.2rem 0.4rem 0;
      color: var(--cyan);
      text-decoration: underline;
    }

    .footer-link:hover { color: #8ff3ff; }

    .success-modal-overlay { position:fixed; inset:0; background:rgba(2,6,16,.72); display:none; align-items:center; justify-content:center; padding:1rem; z-index:1200; }
    .success-modal-overlay.active { display:flex; }
    .success-modal { width:min(560px,96vw); background:linear-gradient(160deg, #101b39, #0d142d); border:1px solid var(--line); border-radius:14px; padding:1rem; }
    .success-modal h3 { margin:.1rem 0 .4rem; color:var(--cyan); }
    .success-modal p { margin:.45rem 0; }
    .admin-panel { margin-top:1rem; display:none; }
    .admin-panel.active { display:block; }
    .admin-lock { border:1px solid var(--line); border-radius:10px; padding:.75rem; background:#0a1230; margin-top:.6rem; }
    .admin-controls { display:none; margin-top:.8rem; }
    .admin-controls.active { display:block; }
    .admin-grid { display:grid; grid-template-columns:1fr 1fr; gap:.8rem; }
    .admin-list { max-height:220px; overflow:auto; border:1px solid var(--line); border-radius:8px; padding:.6rem; background:#0a1230; font-size:.85rem; color:var(--muted); }
    .faq-section { margin-top:1rem; display:grid; gap:0.7rem; }
    .faq-item { background:var(--card); border:1px solid var(--line); border-radius:12px; padding:0.85rem 1rem; }
    .faq-item h3 { margin:0 0 0.35rem; color:var(--cyan); font-size:0.98rem; }
    .faq-item p { margin:0; color:var(--muted); line-height:1.5; font-size:0.92rem; }
    .brand-header { display:flex; align-items:center; gap:0.7rem; margin-bottom:0.6rem; }
    .brand-header svg { width:44px; height:44px; flex-shrink:0; }
    .brand-header-text { font-weight:700; font-size:1.1rem; color:var(--cyan); letter-spacing:0.04em; text-transform:uppercase; line-height:1; }
    .brand-header-text small { display:block; margin-top:0.2rem; font-size:0.55rem; color:var(--muted); letter-spacing:0.14em; font-weight:600; }
    @media (max-width: 760px) { .booking-grid, .admin-grid { grid-template-columns:1fr; } }
  </style>
</head>
<body>
  <div class="container">
    <p><a href="/">← Back to Eastern Shore AI</a></p>

    <div class="brand-header">
      <svg viewBox="0 0 44 44" fill="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="cg" x1="0" y1="0" x2="44" y2="44" gradientUnits="userSpaceOnUse">
            <stop offset="0%" stop-color="#35e7ff"/>
            <stop offset="100%" stop-color="#8f7bff"/>
          </linearGradient>
        </defs>
        <rect width="44" height="44" rx="11" fill="#0a1230"/>
        <rect x="1.5" y="1.5" width="41" height="41" rx="9.5" stroke="url(#cg)" stroke-width="1.5" fill="none"/>
        <!-- gear ring -->
        <circle cx="22" cy="22" r="11" stroke="url(#cg)" stroke-width="1.8" fill="none"/>
        <!-- gear teeth -->
        <rect x="20.5" y="8" width="3" height="4" rx="1" fill="#35e7ff" opacity="0.7"/>
        <rect x="20.5" y="32" width="3" height="4" rx="1" fill="#8f7bff" opacity="0.7"/>
        <rect x="8" y="20.5" width="4" height="3" rx="1" fill="#35e7ff" opacity="0.7"/>
        <rect x="32" y="20.5" width="4" height="3" rx="1" fill="#8f7bff" opacity="0.7"/>
        <!-- claw -->
        <path d="M17 25 Q17 18 22 17 Q27 18 27 25" stroke="url(#cg)" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M17 25 L15 28" stroke="#35e7ff" stroke-width="2" stroke-linecap="round"/>
        <path d="M27 25 L29 28" stroke="#8f7bff" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <div class="brand-header-text">
        OpenClaw Setup
        <small>BY EASTERN SHORE AI</small>
      </div>
    </div>

    <section class="card">
      <h1>OpenClaw Setup in Eastern Shore Maryland</h1>
      <p><strong>$100 no additional fees, 30 days of technical support.</strong> We configure your OpenClaw assistant stack correctly, including safe security setup and best-practice hardening.</p>
      <ul>
        <li>End-to-end OpenClaw install and channel onboarding</li>
        <li>Security hardening and exposure review</li>
        <li>Trusted proxy/auth configuration and safe defaults</li>
        <li>Validation, documentation, and launch handoff</li>
      </ul>
    </section>

    <section class="card" style="margin-top:1rem;">
      <h2>Pick Your Setup Day</h2>
      <div class="booking-grid">
        <div>
          <div class="form-grid" style="margin-top:0;">
            <div>
              <label for="setup-date">Preferred Setup Date</label>
              <input id="setup-date" type="date" />
            </div>
            <div>
              <label for="setup-time">Preferred Time Block</label>
              <select id="setup-time">
                <option value="">Select time block…</option>
              </select>
            </div>
          </div>
        </div>

        <aside class="book-pay-panel">
          <h3 style="margin:.1rem 0 .2rem;">Reserve Your Spot</h3>
          <p>Choose your date, then use Book + Pay Now to secure your setup session.</p>
          <button type="button" class="btn btn-primary btn-wide" id="book-pay-btn">Book + Pay Now</button>
        </aside>
      </div>
    </section>

    <section class="card" style="margin-top:1rem;">
      <h2>Questions Before Your Setup?</h2>
      <form id="setup-page-form">
        <div class="form-grid">
          <div>
            <label for="name">Your Name</label>
            <input id="name" required />
          </div>
          <div>
            <label for="email">Your Email</label>
            <input id="email" type="email" required />
          </div>
          <div class="full">
            <label for="message">Questions</label>
            <textarea id="message" required placeholder="Share any questions before your setup session."></textarea>
          </div>
        </div>
        <div class="form-actions"><button class="btn btn-primary" type="submit">Send Questions</button></div>
        <p class="form-status" id="status"></p>
      </form>
    </section>

    <section class="faq-section" aria-label="OpenClaw setup FAQ">
      <article class="faq-item">
        <h3>What is included in OpenClaw Setup?</h3>
        <p>Installation, secure configuration, hardening, channel onboarding, and launch handoff so your setup is production-ready.</p>
      </article>
      <article class="faq-item">
        <h3>In-person available?</h3>
        <p>Yes — in-person throughout Eastern Shore, MD plus Zoom-based remote support.</p>
      </article>
      <article class="faq-item">
        <h3>Ongoing help after setup?</h3>
        <p>Yes — ongoing technical assistance included at no additional cost.</p>
      </article>
    </section>

    <section class="card admin-panel" id="admin-panel">
      <h2>Admin Booking Controls</h2>
      <div class="admin-lock" id="admin-lock">
        <label for="admin-key">Admin Password</label>
        <div style="display:flex; gap:.5rem; margin-top:.35rem;">
          <input id="admin-key" type="password" placeholder="Enter admin password" />
          <button type="button" class="btn btn-primary" id="admin-unlock-btn">Unlock</button>
        </div>
      </div>

      <div class="admin-controls" id="admin-controls">
        <div class="admin-grid" style="margin-top:.7rem;">
          <div>
            <h3 style="margin:.1rem 0 .4rem;">Block / Unblock Slot</h3>
            <div class="form-grid" style="margin-top:0;">
              <div>
                <label for="admin-date">Date</label>
                <input id="admin-date" type="date" />
              </div>
              <div>
                <label for="admin-time">Time Block</label>
                <select id="admin-time">
                  <option value="">Select block…</option>
                </select>
              </div>
              <div class="full">
                <label for="admin-reason">Reason (optional)</label>
                <input id="admin-reason" placeholder="Unavailable / booked elsewhere" />
              </div>
            </div>
            <div class="form-actions" style="justify-content:flex-start; gap:.5rem;">
              <button type="button" class="btn btn-primary" id="admin-block-btn">Block Slot</button>
              <button type="button" class="btn" id="admin-unblock-btn">Unblock Slot</button>
              <button type="button" class="btn" id="admin-refresh-btn">Refresh</button>
            </div>
          </div>
          <div>
            <h3 style="margin:.1rem 0 .4rem;">Recent Bookings / Blocks</h3>
            <div class="admin-list" id="admin-list">No data yet.</div>
          </div>
        </div>
      </div>
    </section>

    <footer>
      © <span id="year"></span> Eastern Shore AI<br>
      <a href="/#" class="footer-link">Contact Us</a>
      <a href="/#" class="footer-link">Terms of Use</a>
      <a href="/#" class="footer-link">Privacy Policy</a>
    </footer>
  </div>

  <div class="success-modal-overlay" id="success-modal" aria-hidden="true">
    <div class="success-modal" role="dialog" aria-modal="true" aria-labelledby="success-title">
      <h3 id="success-title">Payment Received — Setup Booked ✅</h3>
      <p id="success-details">Your OpenClaw setup appointment is confirmed.</p>
      <div class="form-actions" style="margin-top:1rem;">
        <button type="button" class="btn btn-primary" id="success-close-btn">Got it</button>
      </div>
    </div>
  </div>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    const CONTACT_API_URL = window.CONTACT_API_URL || 'https://eastern-shore-ai-contact.99redder.workers.dev/api/contact';
    const CHECKOUT_API_URL = CONTACT_API_URL.replace('/api/contact', '/api/checkout-session');
    const AVAILABILITY_API_URL = CONTACT_API_URL.replace('/api/contact', '/api/availability');
    const BOOKINGS_API_URL = CONTACT_API_URL.replace('/api/contact', '/api/bookings');
    const BLOCK_SLOT_API_URL = CONTACT_API_URL.replace('/api/contact', '/api/admin/block-slot');

    const form = document.getElementById('setup-page-form');
    const statusEl = document.getElementById('status');
    const submitBtn = form.querySelector('button[type="submit"]');
    const bookPayBtn = document.getElementById('book-pay-btn');
    const successModal = document.getElementById('success-modal');
    const successDetails = document.getElementById('success-details');
    const successCloseBtn = document.getElementById('success-close-btn');

    const setupDateEl = document.getElementById('setup-date');
    const setupTimeEl = document.getElementById('setup-time');

    const adminPanel = document.getElementById('admin-panel');
    const adminLock = document.getElementById('admin-lock');
    const adminControls = document.getElementById('admin-controls');
    const adminKeyEl = document.getElementById('admin-key');
    const adminUnlockBtn = document.getElementById('admin-unlock-btn');
    const adminDateEl = document.getElementById('admin-date');
    const adminTimeEl = document.getElementById('admin-time');
    const adminReasonEl = document.getElementById('admin-reason');
    const adminListEl = document.getElementById('admin-list');
    const adminBlockBtn = document.getElementById('admin-block-btn');
    const adminUnblockBtn = document.getElementById('admin-unblock-btn');
    const adminRefreshBtn = document.getElementById('admin-refresh-btn');

    let unavailableSlots = new Set();

    function openSuccessModal(text) {
      successDetails.textContent = text;
      successModal.classList.add('active');
      successModal.setAttribute('aria-hidden', 'false');
    }

    function closeSuccessModal() {
      successModal.classList.remove('active');
      successModal.setAttribute('aria-hidden', 'true');
    }

    successCloseBtn.addEventListener('click', closeSuccessModal);
    successModal.addEventListener('click', (e) => {
      if (e.target === successModal) closeSuccessModal();
    });

    const TIME_SLOTS = [
      { value: '08:00-10:00', label: '0800 - 1000' },
      { value: '10:00-12:00', label: '1000 - 1200' },
      { value: '12:00-14:00', label: '1200 - 1400' },
      { value: '14:00-16:00', label: '1400 - 1600' },
      { value: '16:00-18:00', label: '1600 - 1800' }
    ];

    function setupAtKey(date, time) {
      return date && time ? `${date}T${time}` : '';
    }

    function renderTimeOptions() {
      const selectedDate = setupDateEl.value;
      const current = setupTimeEl.value;
      const adminCurrent = adminTimeEl.value;
      const userOpts = ['<option value="">Select time block…</option>'];
      const adminOpts = ['<option value="">Select block…</option>'];

      for (const slot of TIME_SLOTS) {
        const unavailable = selectedDate && slotIsUnavailable(selectedDate, slot.value);
        userOpts.push(`<option value="${slot.value}" ${unavailable ? 'disabled' : ''}>${slot.label}${unavailable ? ' (unavailable)' : ''}</option>`);
        adminOpts.push(`<option value="${slot.value}">${slot.label}</option>`);
      }

      setupTimeEl.innerHTML = userOpts.join('');
      adminTimeEl.innerHTML = adminOpts.join('');

      if (current && !(selectedDate && slotIsUnavailable(selectedDate, current))) {
        setupTimeEl.value = current;
      }
      if (adminCurrent) {
        adminTimeEl.value = adminCurrent;
      }
    }

    async function loadAvailability() {
      try {
        const res = await fetch(AVAILABILITY_API_URL, { headers: { 'Content-Type': 'application/json' } });
        const data = await res.json();
        unavailableSlots = new Set((data.unavailable || []).filter(Boolean));
      } catch {
        unavailableSlots = new Set();
      }
      renderTimeOptions();
    }

    function slotIsUnavailable(date, time) {
      return unavailableSlots.has(setupAtKey(date, time));
    }

    setupDateEl.addEventListener('change', renderTimeOptions);
    const adminMode = new URLSearchParams(window.location.search).get('admin') === '1';
    let adminUnlocked = false;
    if (adminMode) {
      adminPanel.classList.add('active');
      adminKeyEl.value = sessionStorage.getItem('esa_admin_key') || '';
    }

    function setAdminUnlocked(on) {
      adminUnlocked = !!on;
      adminLock.style.display = adminUnlocked ? 'none' : 'block';
      adminControls.classList.toggle('active', adminUnlocked);
    }

    async function loadAdminData() {
      if (!adminMode || !adminUnlocked) return;
      const key = adminKeyEl.value.trim();
      try {
        const res = await fetch(`${BOOKINGS_API_URL}?key=${encodeURIComponent(key)}&limit=30`);
        const data = await res.json();
        if (!res.ok) throw new Error(data.error || 'Failed');
        const lines = [];
        for (const b of (data.bookings || [])) lines.push(`[BOOKING] ${b.status} | ${b.setup_at || '(n/a)'} | ${b.customer_name || '(no name)'}`);
        for (const s of (data.blockedSlots || [])) lines.push(`[BLOCKED] ${s.active ? 'active' : 'inactive'} | ${s.setup_at} | ${s.reason || '(no reason)'}`);
        adminListEl.textContent = lines.length ? lines.join('\n') : 'No records yet.';
      } catch (e) {
        adminListEl.textContent = `Error loading admin data: ${e.message || e}`;
      }
    }

    async function setBlockedSlot(active) {
      const key = adminKeyEl.value.trim();
      const setupDate = adminDateEl.value;
      const setupTime = adminTimeEl.value;
      if (!key || !setupDate || !setupTime) {
        alert('Admin key + date + time are required.');
        return;
      }
      try {
        const res = await fetch(`${BLOCK_SLOT_API_URL}?key=${encodeURIComponent(key)}`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            setupDate,
            setupTime,
            reason: adminReasonEl.value.trim(),
            active
          })
        });
        const data = await res.json();
        if (!res.ok) throw new Error(data.error || 'Failed to update slot');
        await loadAvailability();
        await loadAdminData();
      } catch (e) {
        alert(`Could not update slot: ${e.message || e}`);
      }
    }

    if (adminMode) {
      setAdminUnlocked(false);
      adminUnlockBtn.addEventListener('click', async () => {
        const key = adminKeyEl.value.trim();
        if (!key) return;
        try {
          const res = await fetch(`${BOOKINGS_API_URL}?key=${encodeURIComponent(key)}&limit=1`);
          const data = await res.json();
          if (!res.ok) throw new Error(data.error || 'Invalid password');
          sessionStorage.setItem('esa_admin_key', key);
          setAdminUnlocked(true);
          await loadAdminData();
        } catch (e) {
          alert(`Admin unlock failed: ${e.message || e}`);
        }
      });

      if (adminKeyEl.value) {
        adminUnlockBtn.click();
      }

      adminBlockBtn.addEventListener('click', () => setBlockedSlot(true));
      adminUnblockBtn.addEventListener('click', () => setBlockedSlot(false));
      adminRefreshBtn.addEventListener('click', loadAdminData);
    }

    bookPayBtn.addEventListener('click', async () => {
      const setupDate = setupDateEl.value;
      const setupTime = setupTimeEl.value;
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();

      if (!setupDate || !setupTime) {
        alert('Please choose your setup date and time first.');
        return;
      }

      if (slotIsUnavailable(setupDate, setupTime)) {
        alert('That slot is unavailable. Please choose another date/time.');
        return;
      }

      localStorage.setItem('esa_last_setup_slot', JSON.stringify({ setupDate, setupTime }));

      bookPayBtn.disabled = true;
      bookPayBtn.textContent = 'Redirecting…';

      try {
        const res = await fetch(CHECKOUT_API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ setupDate, setupTime, name, email })
        });

        const data = await res.json();
        if (!res.ok || !data.checkoutUrl) throw new Error('Checkout session failed');
        window.location.href = data.checkoutUrl;
      } catch {
        alert('Could not start checkout right now. Please try again.');
        bookPayBtn.disabled = false;
        bookPayBtn.textContent = 'Book + Pay Now';
      }
    });

    const qs = new URLSearchParams(window.location.search);
    if (qs.get('paid') === '1') {
      let dateText = 'your selected date';
      let timeText = 'your selected time';
      try {
        const saved = JSON.parse(localStorage.getItem('esa_last_setup_slot') || '{}');
        if (saved.setupDate) dateText = saved.setupDate;
        if (saved.setupTime) timeText = saved.setupTime;
      } catch {}
      openSuccessModal(`Your OpenClaw setup appointment is confirmed for ${dateText} at ${timeText}.`);
      window.history.replaceState({}, '', '/openclaw-setup.html');
    }

    loadAvailability().then(() => {
      if (adminMode) loadAdminData();
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      submitBtn.disabled = true;
      submitBtn.textContent = 'Sending…';
      statusEl.textContent = '';
      statusEl.className = 'form-status';
      try {
        const preferredDate = document.getElementById('setup-date').value;
        const preferredTime = document.getElementById('setup-time').value;
        const rawQuestions = document.getElementById('message').value.trim();
        const combinedMessage = `Preferred setup date: ${preferredDate || 'not provided'}\nPreferred time: ${preferredTime || 'not provided'}\n\nQuestions:\n${rawQuestions}`;

        const res = await fetch(CONTACT_API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            mode: 'setup_questions',
            name: document.getElementById('name').value.trim(),
            email: document.getElementById('email').value.trim(),
            offer: '',
            message: combinedMessage,
            website: ''
          })
        });
        if (!res.ok) throw new Error('Request failed');
        statusEl.textContent = 'Questions sent successfully.';
        statusEl.className = 'form-status ok';
        form.reset();
      } catch {
        statusEl.textContent = 'Could not send right now. Please try again.';
        statusEl.className = 'form-status err';
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Send Questions';
      }
    });
  </script>
</body>
</html>
